# 📤 Excel 파일 업로드 기능 사용 가이드

## ✨ 새로운 기능

웹 인터페이스의 "데이터셋에 TestCase 생성 및 업데이트" 섹션에 Excel 파일 업로드 기능이 추가되었습니다!

## 🎯 사용 방법

### 1. 웹 인터페이스 실행
```bash
cd /Users/1112049/llm-3
python new_project/run.py
```
또는
```bash
cd /Users/1112049/llm-3/new_project
python web_interface.py
```

### 2. Excel 파일 업로드

#### 방법 A: 파일 업로드 (새 기능!)
1. **🚀 메인 실행** 탭으로 이동
2. **"3. 데이터셋에 TestCase 생성 및 업데이트"** 섹션 확인
3. **"Excel 파일 업로드 (선택사항)"** 영역에서:
   - 📁 클릭하여 파일 탐색기 열기
   - 원하는 `.xlsx` 또는 `.xls` 파일 선택
   - 파일이 업로드되면 파일명이 표시됩니다
4. **"TestCase → LangSmith 저장"** 버튼 클릭
5. 실행 결과 확인
   - 업로드된 파일 정보가 로그에 표시됩니다
   - 예: `📤 업로드된 파일: MyTestCases.xlsx`

#### 방법 B: 기본 파일 사용 (기존 방식)
1. 파일을 업로드하지 않고 바로 **"TestCase → LangSmith 저장"** 버튼 클릭
2. 자동으로 `new_project/TestCase.xlsx` 파일 사용
3. 로그에 `📁 기본 파일 사용: TestCase.xlsx` 표시

## 📋 Excel 파일 형식

업로드할 Excel 파일은 다음 형식을 따라야 합니다:

### 필수 컬럼
- **case_id**: 테스트케이스 고유 ID (예: TC_001, TC_002)
- **question**: 질문 내용

### 선택 컬럼
- **expected_answer**: 기대하는 답변 (있으면 좋지만 필수는 아님)

### 예시
| case_id | question | expected_answer |
|---------|----------|-----------------|
| TC_001 | 날씨는 어때? | 현재 날씨 정보 제공 |
| TC_002 | 서울의 인구는? | 약 1천만 명 |
| TC_003 | 파이썬이란? | 프로그래밍 언어 |

## 🔍 실행 결과 확인

실행 로그에서 다음 정보를 확인할 수 있습니다:

```
🚀 TestCase 저장 실행 시작 (2025-10-02 14:30:00)
📁 업로드된 파일: NewTestCases.xlsx
============================================================
📤 업로드된 파일 사용: NewTestCases.xlsx
📥 TestCase → Agent_QA_Scenario 데이터셋 저장 시작
============================================================
1️⃣  Excel 파일에서 테스트케이스 로드: NewTestCases.xlsx
   ✅ 로드된 테스트케이스 수: 10개
   
2️⃣  LangSmith 'Agent_QA_Scenario' 데이터셋에 저장
   ✅ 새로 추가: 3개
   ⏭️  이미 존재: 7개
   
✅ 테스트케이스 저장 완료!
```

## 💡 팁

1. **여러 파일 테스트**: 다른 Excel 파일을 업로드하여 다양한 테스트케이스 세트를 관리할 수 있습니다.

2. **파일 재사용**: 자주 사용하는 테스트케이스는 `new_project/TestCase.xlsx`에 저장해두면 업로드 없이 바로 사용 가능합니다.

3. **중복 방지**: LangSmith는 `case_id`를 기준으로 중복을 체크하므로, 같은 파일을 여러 번 업로드해도 안전합니다.

4. **대용량 파일**: 많은 테스트케이스가 있는 파일도 업로드 가능하며, 처리 시간이 다소 걸릴 수 있습니다.

## 🔗 다음 단계

1. ✅ TestCase 업로드 완료
2. 🔧 **프롬프트 관리** 탭에서 `accuracy_judge_prompt` 확인/업데이트
3. 🚀 **"4. Judge 프롬프트 실행 후 평가 실행/저장"** 버튼으로 GPT-4o 평가 실행
4. 📊 **평가 결과** 탭에서 결과 확인

## ❓ 문제 해결

### 파일이 업로드되지 않을 때
- 파일 형식이 `.xlsx` 또는 `.xls`인지 확인
- 파일 크기가 너무 크지 않은지 확인 (권장: 10MB 이하)

### "Excel 파일을 찾을 수 없습니다" 오류
- 파일을 업로드했는지 확인
- 기본 파일 사용 시 `new_project/TestCase.xlsx`가 존재하는지 확인

### 컬럼 오류
- Excel 파일에 `case_id`와 `question` 컬럼이 있는지 확인
- 컬럼명의 철자와 대소문자 확인

## 📝 참고

- 업로드된 파일은 임시로 저장되며, 처리 후 자동으로 정리됩니다
- 파일 업로드는 웹 인터페이스에서만 가능하며, CLI 모드에서는 기본 파일만 사용합니다

